<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Candidato ATS - Sistema Completo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js"></script>
    <style>
        [data-lucide] {
            stroke: currentColor;
            stroke-width: 2;
            fill: none;
        }
        .fade-in {
            animation: fadeIn 0.3s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="bg-gray-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, createElement } = React;
        const { render } = ReactDOM;

        // ICONS
        const lucide = window.lucide;
        const Icon = ({ name, className = '', ...props }) => {
            return createElement('i', {
                'data-lucide': name,
                className: `w-5 h-5 ${className}`,
                ...props
            });
        };

        // MAIN COMPONENT
        const ATSApp = () => {
            // STATE
            const [candidates, setCandidates] = useState([]);
            const [filters, setFilters] = useState({
                search: '',
                status: '',
                position: '',
                favorites: false
            });
            const [showForm, setShowForm] = useState(false);
            const [editCandidateId, setEditCandidateId] = useState(null);
            const [formData, setFormData] = useState({
                name: '',
                email: '',
                phone: '',
                position: '',
                skills: [],
                status: 'pending',
                resume: null
            });
            const [newSkill, setNewSkill] = useState('');

            const positions = [
                'Frontend Developer',
                'Backend Developer',
                'Full Stack Developer',
                'UX/UI Designer',
                'Data Analyst',
                'DevOps Engineer',
                'Product Manager'
            ];

            // EFFECTS
            useEffect(() => {
                try {
                    const saved = localStorage.getItem('ats-candidates');
                    if (saved) setCandidates(JSON.parse(saved));
                } catch (error) {
                    console.error('Error loading candidates from localStorage:', error);
                }
            }, []);

            useEffect(() => {
                try {
                    if (candidates.length) {
                        localStorage.setItem('ats-candidates', JSON.stringify(candidates));
                    }
                } catch (error) {
                    console.error('Error saving candidates to localStorage:', error);
                }
            }, [candidates]);

            // HELPERS
            const resetForm = () => {
                setFormData({
                    name: '',
                    email: '',
                    phone: '',
                    position: '',
                    skills: [],
                    status: 'pending',
                    resume: null
                });
                setNewSkill('');
                setEditCandidateId(null);
                setShowForm(false);
            };

            const handleSaveCandidate = () => {
                if (!formData.name || !formData.position) {
                    alert('Name and position are required!');
                    return;
                }

                // Basic email validation
                if (formData.email && !/\S+@\S+\.\S+/.test(formData.email)) {
                    alert('Invalid email format!');
                    return;
                }

                // Basic phone validation (optional)
                if (formData.phone && !/^\+?\d{10,15}$/.test(formData.phone)) {
                    alert('Invalid phone format! Use +1234567890 or similar.');
                    return;
                }

                // Resume size validation
                if (formData.resume && formData.resume.size > 5 * 1024 * 1024) {
                    alert('Resume file too large! Maximum 5MB.');
                    return;
                }

                const resumeData = formData.resume ? {
                    name: formData.resume.name,
                    size: (formData.resume.size / 1024).toFixed(1) + ' KB',
                    type: formData.resume.type
                } : null;

                if (editCandidateId) {
                    // Update existing candidate
                    setCandidates(prev => prev.map(c => 
                        c.id === editCandidateId ? {
                            ...c,
                            ...formData,
                            resume: resumeData
                        } : c
                    ));
                } else {
                    // Add new candidate
                    const newCandidate = {
                        id: Date.now(),
                        ...formData,
                        appliedDate: new Date().toISOString(),
                        isFavorite: false,
                        resume: resumeData
                    };
                    setCandidates(prev => [...prev, newCandidate]);
                }

                resetForm();
            };

            const updateCandidate = (id, updates) => {
                setCandidates(prev => 
                    prev.map(c => c.id === id ? { ...c, ...updates } : c)
                );
            };

            const deleteCandidate = (id) => {
                if (window.confirm('Delete this candidate?')) {
                    setCandidates(prev => prev.filter(c => c.id !== id));
                }
            };

            const toggleFavorite = (id) => {
                setCandidates(prev => 
                    prev.map(c => 
                        c.id === id ? { ...c, isFavorite: !c.isFavorite } : c
                    )
                );
            };

            const addSkill = () => {
                if (newSkill && !formData.skills.includes(newSkill)) {
                    setFormData(prev => ({
                        ...prev,
                        skills: [...prev.skills, newSkill]
                    }));
                    setNewSkill('');
                }
            };

            const removeSkill = (skill) => {
                setFormData(prev => ({
                    ...prev,
                    skills: prev.skills.filter(s => s !== skill)
                }));
            };

            // FILTERING
            const filteredCandidates = candidates.filter(candidate => {
                const matchesSearch = filters.search === '' || 
                    candidate.name.toLowerCase().includes(filters.search.toLowerCase()) || 
                    candidate.email.toLowerCase().includes(filters.search.toLowerCase());
                
                const matchesStatus = filters.status === '' || 
                    candidate.status === filters.status;
                
                const matchesPosition = filters.position === '' || 
                    candidate.position === filters.position;
                
                const matchesFavorites = !filters.favorites || 
                    candidate.isFavorite;
                
                return matchesSearch && matchesStatus && matchesPosition && matchesFavorites;
            });

            // STATS
            const stats = {
                total: candidates.length,
                pending: candidates.filter(c => c.status === 'pending').length,
                approved: candidates.filter(c => c.status === 'approved').length,
                rejected: candidates.filter(c => c.status === 'rejected').length,
                favorites: candidates.filter(c => c.isFavorite).length,
                positions: positions.map(pos => ({
                    name: pos,
                    count: candidates.filter(c => c.position === pos).length
                }))
            };

            // EXPORT/IMPORT
            const exportData = () => {
                try {
                    const data = {
                        candidates,
                        exportedAt: new Date().toISOString(),
                        version: 'ATS 1.5'
                    };
                    const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `ats-backup-${new Date().toISOString().split('T')[0]}.json`;
                    a.click();
                    URL.revokeObjectURL(url);
                } catch (error) {
                    console.error('Error exporting data:', error);
                    alert('Failed to export data');
                }
            };

            const importData = (e) => {
                const file = e.target.files[0];
                if (!file) return;

                const reader = new FileReader();
                reader.onload = (event) => {
                    try {
                        const data = JSON.parse(event.target.result);
                        if (data.candidates && Array.isArray(data.candidates)) {
                            // Validate imported data
                            const validCandidates = data.candidates.filter(c => c.name && c.position);
                            setCandidates(validCandidates);
                            alert(`Imported ${validCandidates.length} valid candidates`);
                        } else {
                            alert('Invalid data format');
                        }
                    } catch (error) {
                        alert('Error parsing file');
                        console.error('Error importing data:', error);
                    }
                };
                reader.readAsText(file);
            };

            // RENDER
            return (
                <div className="min-h-screen">
                    {/* HEADER */}
                    <header className="bg-white shadow-sm">
                        <div className="max-w-7xl mx-auto px-4 py-6">
                            <div className="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
                                <div className="flex items-center gap-3">
                                    <Icon name="users" className="w-8 h-8 text-indigo-600" />
                                    <div>
                                        <h1 className="text-2xl font-bold text-gray-900">Candidate ATS 1.5</h1>
                                        <p className="text-gray-600">Applicant Tracking System</p>
                                    </div>
                                </div>
                                <div className="flex gap-3">
                                    <button
                                        onClick={() => { setEditCandidateId(null); setShowForm(true); }}
                                        className="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-md flex items-center gap-2"
                                    >
                                        <Icon name="user-plus" />
                                        Add Candidate
                                    </button>
                                    <label className="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md flex items-center gap-2 cursor-pointer">
                                        <Icon name="upload" />
                                        Import
                                        <input type="file" accept=".json" onChange={importData} className="hidden" />
                                    </label>
                                    <button
                                        onClick={exportData}
                                        className="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md flex items-center gap-2"
                                    >
                                        <Icon name="download" />
                                        Export
                                    </button>
                                </div>
                            </div>
                        </div>
                    </header>

                    {/* MAIN CONTENT */}
                    <main className="max-w-7xl mx-auto px-4 py-8">
                        {/* STATS CARDS */}
                        <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4 mb-8">
                            <StatCard 
                                title="Total Candidates" 
                                value={stats.total} 
                                icon="users" 
                                color="indigo"
                            />
                            <StatCard 
                                title="Pending" 
                                value={stats.pending} 
                                icon="clock" 
                                color="yellow"
                            />
                            <StatCard 
                                title="Approved" 
                                value={stats.approved} 
                                icon="check-circle" 
                                color="green"
                            />
                            <StatCard 
                                title="Rejected" 
                                value={stats.rejected} 
                                icon="x-circle" 
                                color="red"
                            />
                            <StatCard 
                                title="Favorites" 
                                value={stats.favorites} 
                                icon="star" 
                                color="purple"
                            />
                        </div>

                        {/* CANDIDATE FORM MODAL */}
                        {showForm && (
                            <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
                                <div className="bg-white rounded-lg shadow-xl w-full max-w-2xl fade-in">
                                    <div className="px-6 py-4 border-b flex justify-between items-center">
                                        <h3 className="text-lg font-semibold">{editCandidateId ? 'Edit Candidate' : 'Add New Candidate'}</h3>
                                        <button onClick={resetForm}>
                                            <Icon name="x" className="text-gray-500 hover:text-gray-700" />
                                        </button>
                                    </div>
                                    <div className="p-6">
                                        <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                            <div>
                                                <label className="block text-sm font-medium text-gray-700 mb-1">Full Name*</label>
                                                <input
                                                    type="text"
                                                    value={formData.name}
                                                    onChange={(e) => setFormData({...formData, name: e.target.value})}
                                                    className="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500"
                                                    placeholder="John Doe"
                                                />
                                            </div>
                                            <div>
                                                <label className="block text-sm font-medium text-gray-700 mb-1">Email</label>
                                                <input
                                                    type="email"
                                                    value={formData.email}
                                                    onChange={(e) => setFormData({...formData, email: e.target.value})}
                                                    className="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500"
                                                    placeholder="john@example.com"
                                                />
                                            </div>
                                            <div>
                                                <label className="block text-sm font-medium text-gray-700 mb-1">Phone</label>
                                                <input
                                                    type="tel"
                                                    value={formData.phone}
                                                    onChange={(e) => setFormData({...formData, phone: e.target.value})}
                                                    className="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500"
                                                    placeholder="+1234567890"
                                                />
                                            </div>
                                            <div>
                                                <label className="block text-sm font-medium text-gray-700 mb-1">Position*</label>
                                                <select
                                                    value={formData.position}
                                                    onChange={(e) => setFormData({...formData, position: e.target.value})}
                                                    className="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500"
                                                >
                                                    <option value="">Select position</option>
                                                    {positions.map(pos => (
                                                        <option key={pos} value={pos}>{pos}</option>
                                                    ))}
                                                </select>
                                            </div>
                                            <div className="md:col-span-2">
                                                <label className="block text-sm font-medium text-gray-700 mb-1">Skills</label>
                                                <div className="flex gap-2 mb-2">
                                                    <input
                                                        type="text"
                                                        value={newSkill}
                                                        onChange={(e) => setNewSkill(e.target.value)}
                                                        className="flex-1 px-3 py-2 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500"
                                                        placeholder="Add skill"
                                                    />
                                                    <button
                                                        onClick={addSkill}
                                                        className="bg-gray-200 hover:bg-gray-300 px-4 py-2 rounded-md"
                                                    >
                                                        Add
                                                    </button>
                                                </div>
                                                <div className="flex flex-wrap gap-2">
                                                    {formData.skills.map(skill => (
                                                        <span key={skill} className="inline-flex items-center bg-gray-100 px-3 py-1 rounded-full text-sm">
                                                            {skill}
                                                            <button 
                                                                onClick={() => removeSkill(skill)}
                                                                className="ml-2 text-gray-500 hover:text-gray-700"
                                                            >
                                                                <Icon name="x" className="w-3 h-3" />
                                                            </button>
                                                        </span>
                                                    ))}
                                                </div>
                                            </div>
                                            <div className="md:col-span-2">
                                                <label className="block text-sm font-medium text-gray-700 mb-1">Resume</label>
                                                <div className="border-2 border-dashed border-gray-300 rounded-md p-4 text-center">
                                                    {formData.resume ? (
                                                        <div className="flex items-center justify-between bg-gray-50 p-3 rounded">
                                                            <div className="flex items-center gap-2">
                                                                <Icon name="file-text" className="text-gray-500" />
                                                                <div>
                                                                    <p className="text-sm font-medium">{formData.resume.name}</p>
                                                                    <p className="text-xs text-gray-500">
                                                                        {formData.resume.size ? formData.resume.size : (Math.round(formData.resume.size / 1024) + ' KB')}
                                                                    </p>
                                                                </div>
                                                            </div>
                                                            <button 
                                                                onClick={() => setFormData({...formData, resume: null})}
                                                                className="text-gray-500 hover:text-gray-700"
                                                            >
                                                                <Icon name="x" className="w-4 h-4" />
                                                            </button>
                                                        </div>
                                                    ) : (
                                                        <label className="cursor-pointer">
                                                            <div className="flex flex-col items-center justify-center gap-2">
                                                                <Icon name="upload-cloud" className="w-8 h-8 text-gray-400" />
                                                                <p className="text-sm text-gray-600">
                                                                    <span className="font-medium text-indigo-600">Click to upload</span> or drag and drop
                                                                </p>
                                                                <p className="text-xs text-gray-500">PDF, DOCX up to 5MB</p>
                                                            </div>
                                                            <input
                                                                type="file"
                                                                className="hidden"
                                                                accept=".pdf,.doc,.docx"
                                                                onChange={(e) => {
                                                                    const file = e.target.files[0];
                                                                    if (file) {
                                                                        setFormData({...formData, resume: file});
                                                                    }
                                                                }}
                                                            />
                                                        </label>
                                                    )}
                                                </div>
                                            </div>
                                            <div>
                                                <label className="block text-sm font-medium text-gray-700 mb-1">Status</label>
                                                <select
                                                    value={formData.status}
                                                    onChange={(e) => setFormData({...formData, status: e.target.value})}
                                                    className="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500"
                                                >
                                                    <option value="pending">Pending</option>
                                                    <option value="approved">Approved</option>
                                                    <option value="rejected">Rejected</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    <div className="px-6 py-4 border-t flex justify-end gap-3">
                                        <button
                                            onClick={resetForm}
                                            className="px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50"
                                        >
                                            Cancel
                                        </button>
                                        <button
                                            onClick={handleSaveCandidate}
                                            className="px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700"
                                        >
                                            {editCandidateId ? 'Update Candidate' : 'Save Candidate'}
                                        </button>
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* FILTERS */}
                        <div className="bg-white rounded-lg shadow-sm p-4 mb-6">
                            <div className="flex flex-col md:flex-row md:items-center gap-4">
                                <div className="flex-1">
                                    <label className="sr-only">Search</label>
                                    <div className="relative">
                                        <div className="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                            <Icon name="search" className="text-gray-400" />
                                        </div>
                                        <input
                                            type="text"
                                            placeholder="Search candidates..."
                                            value={filters.search}
                                            onChange={(e) => setFilters({...filters, search: e.target.value})}
                                            className="block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"
                                        />
                                    </div>
                                </div>
                                <div className="grid grid-cols-2 sm:grid-cols-3 gap-2">
                                    <select
                                        value={filters.status}
                                        onChange={(e) => setFilters({...filters, status: e.target.value})}
                                        className="block w-full pl-3 pr-10 py-2 text-base border border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"
                                    >
                                        <option value="">All Status</option>
                                        <option value="pending">Pending</option>
                                        <option value="approved">Approved</option>
                                        <option value="rejected">Rejected</option>
                                    </select>
                                    <select
                                        value={filters.position}
                                        onChange={(e) => setFilters({...filters, position: e.target.value})}
                                        className="block w-full pl-3 pr-10 py-2 text-base border border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"
                                    >
                                        <option value="">All Positions</option>
                                        {positions.map(pos => (
                                            <option key={pos} value={pos}>{pos}</option>
                                        ))}
                                    </select>
                                    <button
                                        onClick={() => setFilters({...filters, favorites: !filters.favorites})}
                                        className={`flex items-center justify-center px-4 py-2 border rounded-md text-sm font-medium ${
                                            filters.favorites 
                                                ? 'bg-yellow-100 border-yellow-200 text-yellow-800'
                                                : 'bg-white border-gray-300 text-gray-700 hover:bg-gray-50'
                                        }`}
                                    >
                                        <Icon name="star" className={filters.favorites ? 'fill-current text-yellow-500' : 'text-gray-400'} />
                                        <span className="ml-2">Favorites</span>
                                    </button>
                                </div>
                            </div>
                        </div>

                        {/* CANDIDATES LIST */}
                        <div className="bg-white rounded-lg shadow-sm overflow-hidden">
                            <div className="px-6 py-4 border-b">
                                <h3 className="text-lg font-medium">
                                    Candidates ({filteredCandidates.length})
                                </h3>
                            </div>
                            
                            {filteredCandidates.length === 0 ? (
                                <div className="text-center py-12">
                                    <Icon name="users" className="mx-auto h-12 w-12 text-gray-400" />
                                    <h3 className="mt-2 text-sm font-medium text-gray-900">No candidates</h3>
                                    <p className="mt-1 text-sm text-gray-500">
                                        {candidates.length === 0 
                                            ? 'Get started by adding a new candidate'
                                            : 'No candidates match your filters'
                                        }
                                    </p>
                                    <div className="mt-6">
                                        <button
                                            onClick={() => { setEditCandidateId(null); setShowForm(true); }}
                                            className="inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none"
                                        >
                                            <Icon name="user-plus" className="-ml-1 mr-2 h-5 w-5" />
                                            Add Candidate
                                        </button>
                                    </div>
                                </div>
                            ) : (
                                <ul className="divide-y divide-gray-200">
                                    {filteredCandidates.map(candidate => (
                                        <li key={candidate.id} className="hover:bg-gray-50 transition-colors">
                                            <div className="px-6 py-4">
                                                <div className="flex items-center justify-between">
                                                    <div className="flex items-center gap-4">
                                                        <div className="flex-shrink-0">
                                                            <div className="h-10 w-10 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-600 font-medium">
                                                                {candidate.name.charAt(0).toUpperCase()}
                                                            </div>
                                                        </div>
                                                        <div>
                                                            <div className="flex items-center gap-2">
                                                                <h4 className="text-lg font-medium text-gray-900">
                                                                    {candidate.name}
                                                                </h4>
                                                                {candidate.isFavorite && (
                                                                    <Icon name="star" className="w-4 h-4 fill-current text-yellow-400" />
                                                                )}
                                                            </div>
                                                            <div className="mt-1 flex flex-wrap items-center gap-x-4 gap-y-1 text-sm text-gray-500">
                                                                <div className="flex items-center">
                                                                    <Icon name="mail" className="mr-1.5 h-4 w-4 flex-shrink-0 text-gray-400" />
                                                                    {candidate.email || 'No email'}
                                                                </div>
                                                                <div className="flex items-center">
                                                                    <Icon name="phone" className="mr-1.5 h-4 w-4 flex-shrink-0 text-gray-400" />
                                                                    {candidate.phone || 'No phone'}
                                                                </div>
                                                                <div className="flex items-center">
                                                                    <Icon name="briefcase" className="mr-1.5 h-4 w-4 flex-shrink-0 text-gray-400" />
                                                                    {candidate.position}
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div className="flex items-center gap-2">
                                                        <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${
                                                            candidate.status === 'approved' 
                                                                ? 'bg-green-100 text-green-800'
                                                                : candidate.status === 'rejected'
                                                                ? 'bg-red-100 text-red-800'
                                                                : 'bg-yellow-100 text-yellow-800'
                                                        }`}>
                                                            {candidate.status.charAt(0).toUpperCase() + candidate.status.slice(1)}
                                                        </span>
                                                    </div>
                                                </div>
                                                
                                                {candidate.skills.length > 0 && (
                                                    <div className="mt-3 ml-14">
                                                        <div className="flex flex-wrap gap-1">
                                                            {candidate.skills.map(skill => (
                                                                <span key={skill} className="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-800">
                                                                    {skill}
                                                                </span>
                                                            ))}
                                                        </div>
                                                    </div>
                                                )}
                                                
                                                {candidate.resume && (
                                                    <div className="mt-3 ml-14 flex items-center text-sm text-gray-500">
                                                        <Icon name="file-text" className="mr-1.5 h-4 w-4 flex-shrink-0 text-gray-400" />
                                                        {candidate.resume.name} ({candidate.resume.size})
                                                    </div>
                                                )}
                                                
                                                <div className="mt-4 ml-14 flex justify-end gap-2">
                                                    <button
                                                        onClick={() => toggleFavorite(candidate.id)}
                                                        className={`p-2 rounded-md ${
                                                            candidate.isFavorite 
                                                                ? 'bg-yellow-50 text-yellow-500 hover:bg-yellow-100'
                                                                : 'bg-gray-50 text-gray-400 hover:bg-gray-100'
                                                        }`}
                                                    >
                                                        <Icon name="star" className={candidate.isFavorite ? 'fill-current' : ''} />
                                                    </button>
                                                    <button
                                                        onClick={() => {
                                                            setFormData({
                                                                name: candidate.name,
                                                                email: candidate.email || '',
                                                                phone: candidate.phone || '',
                                                                position: candidate.position,
                                                                skills: candidate.skills || [],
                                                                status: candidate.status,
                                                                resume: candidate.resume // metadata only
                                                            });
                                                            setEditCandidateId(candidate.id);
                                                            setShowForm(true);
                                                        }}
                                                        className="p-2 bg-blue-50 text-blue-500 rounded-md hover:bg-blue-100"
                                                    >
                                                        <Icon name="edit" className="w-4 h-4" />
                                                    </button>
                                                    <button
                                                        onClick={() => deleteCandidate(candidate.id)}
                                                        className="p-2 bg-red-50 text-red-500 rounded-md hover:bg-red-100"
                                                    >
                                                        <Icon name="trash-2" className="w-4 h-4" />
                                                    </button>
                                                    <button
                                                        onClick={() => {
                                                            const newStatus = candidate.status === 'approved' 
                                                                ? 'rejected' 
                                                                : candidate.status === 'rejected'
                                                                ? 'pending'
                                                                : 'approved';
                                                            updateCandidate(candidate.id, { status: newStatus });
                                                        }}
                                                        className={`p-2 rounded-md ${
                                                            candidate.status === 'approved'
                                                                ? 'bg-red-50 text-red-500 hover:bg-red-100'
                                                                : candidate.status === 'rejected'
                                                                ? 'bg-yellow-50 text-yellow-500 hover:bg-yellow-100'
                                                                : 'bg-green-50 text-green-500 hover:bg-green-100'
                                                        }`}
                                                    >
                                                        {candidate.status === 'approved'
                                                            ? <Icon name="x" className="w-4 h-4" />
                                                            : candidate.status === 'rejected'
                                                            ? <Icon name="clock" className="w-4 h-4" />
                                                            : <Icon name="check" className="w-4 h-4" />
                                                        }
                                                    </button>
                                                </div>
                                            </div>
                                        </li>
                                    ))}
                                </ul>
                            )}
                        </div>
                    </main>

                    {/* FOOTER */}
                    <footer className="bg-white border-t mt-8">
                        <div className="max-w-7xl mx-auto px-4 py-6">
                            <p className="text-center text-sm text-gray-500">
                                Candidate ATS 1.5 - Data is stored locally in your browser (Note: Resume files are not persisted across refreshes, only metadata)
                            </p>
                        </div>
                    </footer>
                </div>
            );
        };

        // STAT CARD COMPONENT
        const StatCard = ({ title, value, icon, color }) => {
            const colorClasses = {
                indigo: 'bg-indigo-100 text-indigo-600',
                yellow: 'bg-yellow-100 text-yellow-600',
                green: 'bg-green-100 text-green-600',
                red: 'bg-red-100 text-red-600',
                purple: 'bg-purple-100 text-purple-600'
            };

            return (
                <div className="bg-white rounded-lg shadow-sm p-4">
                    <div className="flex items-center justify-between">
                        <div>
                            <p className="text-sm font-medium text-gray-500">{title}</p>
                            <p className="text-2xl font-semibold text-gray-900">{value}</p>
                        </div>
                        <div className={`p-3 rounded-lg ${colorClasses[color]}`}>
                            <Icon name={icon} className="w-6 h-6" />
                        </div>
                    </div>
                </div>
            );
        };

        // ERROR BOUNDARY
        class ErrorBoundary extends React.Component {
            state = { hasError: false };

            static getDerivedStateFromError(error) {
                return { hasError: true };
            }

            componentDidCatch(error, errorInfo) {
                console.error('Error caught by ErrorBoundary:', error, errorInfo);
            }

            render() {
                if (this.state.hasError) {
                    return (
                        <div className="text-center py-12">
                            <h3 className="text-lg font-medium text-gray-900">Something went wrong</h3>
                            <p className="mt-2 text-sm text-gray-500">
                                Please try refreshing the page or contact support.
                            </p>
                        </div>
                    );
                }
                return this.props.children;
            }
        }

        // INITIALIZE APP
        try {
            render(
                <React.StrictMode>
                    <ErrorBoundary>
                        <ATSApp />
                    </ErrorBoundary>
                </React.StrictMode>,
                document.getElementById('root')
            );
            
            // Initialize Lucide icons
            lucide.createIcons();
            
            // Watch for dynamic icon additions
            const observer = new MutationObserver(() => {
                lucide.createIcons();
            });
            observer.observe(document.getElementById('root'), { 
                childList: true, 
                subtree: true 
            });
        } catch (error) {
            console.error('Error rendering app:', error);
            document.getElementById('root').innerHTML = `
                <div class="text-center py-12">
                    <h3 class="text-lg font-medium text-gray-900">Failed to load application</h3>
                    <p class="mt-2 text-sm text-gray-500">Please check your internet connection or try again later.</p>
                </div>
            `;
        }
    </script>
</body>
</html>